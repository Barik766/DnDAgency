<div class="campaign-details-page">
  <div class="container">
    
    <!-- –°–æ—Å—Ç–æ—è–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ—à–∏–±–æ–∫ -->
    @if (isLoading) {
      <div class="loading-state">
        <div class="loading-icon">‚öîÔ∏è</div>
        <p>–ì–æ—Ç–æ–≤–∏–º –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ...</p>
      </div>
    }

    @if (error) {
      <div class="error-state">
        <div class="error-icon">üõ°Ô∏è</div>
        <h3>–£–ø—Å! –ß—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫</h3>
        <p>{{ error }}</p>
      </div>
    }

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    @if (!isLoading && campaign) {
      <div class="campaign-content">
        
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞–º–ø–∞–Ω–∏–∏ -->
        <div class="campaign-header">
          <div class="campaign-image-container">
            <img [src]="campaign.imageUrl" [alt]="campaign.title" class="campaign-image">
            <div class="image-overlay"></div>
          </div>
          
          <div class="campaign-info">
            <h1 class="campaign-title">{{ campaign.title }}</h1>
            <p class="campaign-description">{{ campaign.description }}</p>
            
            <div class="campaign-stats">
              <div class="stat-item">
                <span class="stat-label">–£—Ä–æ–≤–µ–Ω—å</span>
                <span class="stat-value">{{ campaign.level }}</span>
              </div>
              <div class="stat-item">
                <span class="stat-label">–¶–µ–Ω–∞</span>
                <span class="stat-value">${{ campaign.price }}</span>
              </div>
              @if (campaign.durationHours) {
                <div class="stat-item">
                  <span class="stat-label">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</span>
                  <span class="stat-value">{{ campaign.durationHours }}—á</span>
                </div>
              }
              <div class="stat-item">
                <span class="stat-label">–ú–∞—Å—Ç–µ—Ä</span>
                <span class="stat-value">{{ campaign.masterName }}</span>
              </div>
            </div>
            
            @if (campaign.tags.length) {
              <div class="campaign-tags">
                <span class="tag" *ngFor="let tag of campaign.tags">{{ tag }}</span>
              </div>
            }
          </div>
        </div>

        <!-- –°–µ–∫—Ü–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
        <div class="booking-section">
          <h2 class="section-title">–ó–ê–ë–†–û–ù–ò–†–û–í–ê–¢–¨ –ü–†–ò–ö–õ–Æ–ß–ï–ù–ò–ï</h2>
          
          <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ –∏–≥—Ä—ã -->
          <div class="booking-step">
            <h3 class="step-title">–¢–∏–ø –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è</h3>
            <div class="game-type-options">
              <label class="radio-option">
                <input type="radio" name="gameType" value="online" [(ngModel)]="selectedGameType" (change)="onGameTypeChange()">
                <span class="radio-custom"></span>
                <span class="option-text">üåê –û–Ω–ª–∞–π–Ω</span>
              </label>
              <label class="radio-option">
                <input type="radio" name="gameType" value="offline" [(ngModel)]="selectedGameType" (change)="onGameTypeChange()">
                <span class="radio-custom"></span>
                <span class="option-text">üè† –û—Ñ—Ñ–ª–∞–π–Ω</span>
              </label>
            </div>
          </div>

          <!-- –í—ã–±–æ—Ä –¥–∞—Ç—ã -->
          @if (selectedGameType) {
            <div class="booking-step">
              <h3 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h3>
              <div class="input-group">
                <input
                  type="date"
                  class="tavern-input"
                  [min]="getTomorrowDate()"
                  [value]="selectedDate"
                  (change)="onDateChange($event)"
                  [formControl]="bookingForm.controls['date']"
                />
              </div>
            </div>
          }

          <!-- –í—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ -->
          @if (selectedDate) {
            <div class="booking-step">
              <h3 class="step-title">–í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</h3>
              
              @if (isLoadingTimeSlots) {
                <div class="loading-slots">
                  <span class="spinner">‚è≥</span>
                  –ò—â–µ–º —Å–≤–æ–±–æ–¥–Ω—ã–µ —Å–ª–æ—Ç—ã...
                </div>
              }

              @if (!isLoadingTimeSlots && availableTimeSlots.length > 0) {
                <div class="time-slots">
                  <select
                    class="tavern-select"
                    [formControl]="bookingForm.controls['dateTime']"
                    (change)="onTimeSlotChange($event)"
                  >
                    <option value="">üïê –í—ã–±–µ—Ä–∏—Ç–µ –≤—Ä–µ–º—è</option>
                    <option
                      *ngFor="let timeSlot of availableTimeSlots"
                      [value]="timeSlot.dateTime"
                      [disabled]="!timeSlot.isAvailable"
                    >
                      {{ timeSlot.dateTime | date:'HH:mm' }} 
                      ({{ timeSlot.maxPlayers - timeSlot.currentPlayers }} –º–µ—Å—Ç)
                    </option>
                  </select>
                </div>
              }

              @if (!isLoadingTimeSlots && availableTimeSlots.length === 0) {
                <div class="no-slots">
                  <div class="no-slots-icon">üìÖ</div>
                  <p>–ù–∞ –≤—ã–±—Ä–∞–Ω–Ω—É—é –¥–∞—Ç—É –Ω–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤</p>
                </div>
              }
            </div>
          }

          <!-- –í—ã–±–æ—Ä –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–≥—Ä–æ–∫–æ–≤ -->
          @if (selectedDateTime) {
            <div class="booking-step">
              <h3 class="step-title">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤</h3>
              <div class="players-selection">
                <input
                  type="number"
                  class="tavern-input players-input"
                  min="1"
                  [max]="getMaxPlayersForTimeSlot()"
                  [(ngModel)]="reservedPlayers"
                  [formControl]="bookingForm.controls['players']"
                  placeholder="1"
                />
                <span class="players-text">–∏–∑ {{ getMaxPlayersForTimeSlot() }} –≤–æ–∑–º–æ–∂–Ω—ã—Ö</span>
              </div>
              
              <!-- –ö–Ω–æ–ø–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è -->
              <div class="booking-action">
                <button 
                  class="btn btn--primary btn--large"
                  (click)="onReserve()" 
                  [disabled]="!selectedDateTime"
                >
                  ‚öîÔ∏è –ó–ê–ë–†–û–ù–ò–†–û–í–ê–¢–¨ –ü–†–ò–ö–õ–Æ–ß–ï–ù–ò–ï
                </button>
              </div>
            </div>
          }
        </div>
        
      </div>
    }
  </div>
</div>