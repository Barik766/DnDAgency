<div class="auth-container">
  <div class="tavern-backdrop">
    <div class="auth-parchment">
      <!-- –õ–æ–≥–æ—Ç–∏–ø —Ç–∞–≤–µ—Ä–Ω—ã -->
      <div class="tavern-sign">
        <h1>üè∞ –¢–∞–≤–µ—Ä–Ω–∞ D&D</h1>
        <p>–ú–µ—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∏ –∏—Å–∫–∞—Ç–µ–ª–µ–π –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π</p>
      </div>

      <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ñ–æ—Ä–º—ã -->
      <div class="form-toggle">
        <button 
          type="button"
          [class.active]="!isRegisterMode()"
          (click)="toggleMode()">
          –í–æ–π—Ç–∏ –≤ —Ç–∞–≤–µ—Ä–Ω—É
        </button>
        <button 
          type="button"
          [class.active]="isRegisterMode()"
          (click)="toggleMode()">
          –°—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–ª—å—Ü–µ–º
        </button>
      </div>

      <!-- –ö–Ω–æ–ø–∫–∞ Google OAuth -->
      <div class="google-auth">
        <button id="google-signin-button" type="button" class="google-btn">
          –í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ Google
        </button>
      </div>

      <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥–∞ -->
      <form *ngIf="!isRegisterMode()" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="auth-form">
        <h2>üóùÔ∏è –í—Ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç–æ—è–ª—å—Ü–µ–≤</h2>
        
        <div class="form-group">
          <label for="loginEmail">–ü–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫</label>
          <input 
            id="loginEmail"
            type="email" 
            formControlName="email"
            placeholder="your.name@tavern.com"
            autocomplete="email"
            [class.error]="getFieldError('email')">
          <div *ngIf="getFieldError('email')" class="error-message">
            {{ getFieldError('email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="loginPassword">–ü–∞—Ä–æ–ª—å</label>
          <input 
            id="loginPassword"
            type="password" 
            formControlName="password"
            placeholder="–°–µ–∫—Ä–µ—Ç–Ω–æ–µ —Å–ª–æ–≤–æ"
            autocomplete="current-password"
            [class.error]="getFieldError('password')">
          <div *ngIf="getFieldError('password')" class="error-message">
            {{ getFieldError('password') }}
          </div>
        </div>

        <button type="submit" [disabled]="loginForm.invalid || isLoading()" class="cta-button">
          <span *ngIf="!isLoading()">‚öîÔ∏è –í–æ–π—Ç–∏ –≤ —Ç–∞–≤–µ—Ä–Ω—É</span>
          <span *ngIf="isLoading()">üé≤ –ë—Ä–æ—Å–∞–µ–º –∫–æ—Å—Ç–∏...</span>
        </button>
      </form>

      <!-- –§–æ—Ä–º–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
      <form *ngIf="isRegisterMode()" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="auth-form">
        <h2>üìú –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ—Å—Ç–æ—è–ª—å—Ü–∞</h2>
        
        <div class="form-group">
          <label for="registerUsername">–ò–º—è –∏—Å–∫–∞—Ç–µ–ª—è –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π</label>
          <input 
            id="registerUsername"
            type="text" 
            formControlName="username"
            placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è"
            autocomplete="email"
            [class.error]="getFieldError('username')">
          <div *ngIf="getFieldError('username')" class="error-message">
            {{ getFieldError('username') }}
          </div>
        </div>

        <div class="form-group">
          <label for="registerEmail">–ü–æ—á—Ç–æ–≤—ã–π —è—â–∏–∫</label>
          <input 
            id="registerEmail"
            type="email" 
            formControlName="email"
            placeholder="your.name@tavern.com"
            [class.error]="getFieldError('email')">
          <div *ngIf="getFieldError('email')" class="error-message">
            {{ getFieldError('email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="registerPassword">–ü–∞—Ä–æ–ª—å</label>
          <input 
            id="registerPassword"
            type="password" 
            formControlName="password"
            placeholder="–ü—Ä–∏–¥—É–º–∞–π—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å"
            autocomplete="new-password"
            [class.error]="getFieldError('password')">
          <div *ngIf="getFieldError('password')" class="error-message">
            {{ getFieldError('password') }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
          <input 
            id="confirmPassword"
            type="password" 
            formControlName="confirmPassword"
            placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å"
            autocomplete="new-password"
            [class.error]="getFieldError('confirmPassword')">
          <div *ngIf="getFieldError('confirmPassword')" class="error-message">
            {{ getFieldError('confirmPassword') }}
          </div>
        </div>

        <div *ngIf="registerForm.errors?.['passwordMismatch'] && registerForm.touched" class="error-message" style="text-align: center; margin-top: -1rem;">
          –ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç
        </div>

        <button type="submit" [disabled]="registerForm.invalid || isLoading()" class="cta-button">
          <span *ngIf="!isLoading()">üõ°Ô∏è –°—Ç–∞—Ç—å –ø–æ—Å—Ç–æ—è–ª—å—Ü–µ–º</span>
          <span *ngIf="isLoading()">üìã –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –≤ –∫–Ω–∏–≥—É...</span>
        </button>

        
      </form>

      

      <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
      <div *ngIf="notification()?.message" 
           [class]="'notification-banner ' + (notification()?.type || '')">
        <span class="notification-icon">{{ getNotificationIcon(notification()?.type || '') }}</span>
        {{ notification()?.message }}
      </div>
    </div>
  </div>
</div>