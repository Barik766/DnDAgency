<div class="auth-container">
  <div class="tavern-backdrop">
    <div class="auth-parchment">
      <!-- Tavern Logo -->
      <div class="tavern-sign">
        <h1>🏰 D&D Tavern</h1>
        <p>A meeting place for adventurers</p>
      </div>

      <!-- Form Toggle -->
      <div class="form-toggle">
        <button 
          type="button"
          [class.active]="!isRegisterMode()"
          (click)="toggleMode()">
          Sign In to the Tavern
        </button>
        <button 
          type="button"
          [class.active]="isRegisterMode()"
          (click)="toggleMode()">
          Become a Guest
        </button>
      </div>

      <!-- Google OAuth Button -->
      <div class="google-auth">
        <button id="google-signin-button" type="button" class="google-btn">
          Sign in with Google
        </button>
      </div>

      <!-- Login Form -->
      <form *ngIf="!isRegisterMode()" [formGroup]="loginForm" (ngSubmit)="onLogin()" class="auth-form">
        <h2>🗝️ Guest Login</h2>
        
        <div class="form-group">
          <label for="loginEmail">Email</label>
          <input 
            id="loginEmail"
            type="email" 
            formControlName="email"
            placeholder="your.name@tavern.com"
            autocomplete="email"
            [class.error]="getFieldError('email')">
          <div *ngIf="getFieldError('email')" class="error-message">
            {{ getFieldError('email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input 
            id="loginPassword"
            type="password" 
            formControlName="password"
            placeholder="Secret word"
            autocomplete="current-password"
            [class.error]="getFieldError('password')">
          <div *ngIf="getFieldError('password')" class="error-message">
            {{ getFieldError('password') }}
          </div>
        </div>

        <button type="submit" [disabled]="loginForm.invalid || isLoading()" class="cta-button">
          <span *ngIf="!isLoading()">⚔️ Enter the Tavern</span>
          <span *ngIf="isLoading()">🎲 Rolling the dice...</span>
        </button>
      </form>

      <!-- Registration Form -->
      <form *ngIf="isRegisterMode()" [formGroup]="registerForm" (ngSubmit)="onRegister()" class="auth-form">
        <h2>📜 Guest Registration</h2>
        
        <div class="form-group">
          <label for="registerUsername">Adventurer's Name</label>
          <input 
            id="registerUsername"
            type="text" 
            formControlName="username"
            placeholder="Enter your name"
            autocomplete="email"
            [class.error]="getFieldError('username')">
          <div *ngIf="getFieldError('username')" class="error-message">
            {{ getFieldError('username') }}
          </div>
        </div>

        <div class="form-group">
          <label for="registerEmail">Email</label>
          <input 
            id="registerEmail"
            type="email" 
            formControlName="email"
            placeholder="your.name@tavern.com"
            [class.error]="getFieldError('email')">
          <div *ngIf="getFieldError('email')" class="error-message">
            {{ getFieldError('email') }}
          </div>
        </div>

        <div class="form-group">
          <label for="registerPassword">Password</label>
          <input 
            id="registerPassword"
            type="password" 
            formControlName="password"
            placeholder="Create a strong password"
            autocomplete="new-password"
            [class.error]="getFieldError('password')">
          <div *ngIf="getFieldError('password')" class="error-message">
            {{ getFieldError('password') }}
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm Password</label>
          <input 
            id="confirmPassword"
            type="password" 
            formControlName="confirmPassword"
            placeholder="Repeat password"
            autocomplete="new-password"
            [class.error]="getFieldError('confirmPassword')">
          <div *ngIf="getFieldError('confirmPassword')" class="error-message">
            {{ getFieldError('confirmPassword') }}
          </div>
        </div>

        <div *ngIf="registerForm.errors?.['passwordMismatch'] && registerForm.touched" class="error-message" style="text-align: center; margin-top: -1rem;">
          Passwords do not match
        </div>

        <button type="submit" [disabled]="registerForm.invalid || isLoading()" class="cta-button">
          <span *ngIf="!isLoading()">🛡️ Become a Guest</span>
          <span *ngIf="isLoading()">📋 Writing in the book...</span>
        </button>
      </form>

      <!-- Notifications -->
      <div *ngIf="notification()?.message" 
           [class]="'notification-banner ' + (notification()?.type || '')">
        <span class="notification-icon">{{ getNotificationIcon(notification()?.type || '') }}</span>
        {{ notification()?.message }}
      </div>
    </div>
  </div>
</div>
